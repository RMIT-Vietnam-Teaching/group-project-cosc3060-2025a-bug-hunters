<div class="container mt-4 mb-4 ">
  <div class="d-flex" style="margin-left: 1.5rem;">
    <div class="dropdown">
      <button class="btn btn-light border rounded-pill px-4 py-2 fw-medium shadow-sm d-flex align-items-center gap-2"
              type="button" data-bs-toggle="dropdown" aria-expanded="false"
              style="font-size: 15px;">
        <i class="bi bi-arrow-down-up"></i>
        Sort by
      </button>
      <ul class="dropdown-menu rounded-4 shadow-sm">
        <li><a class="dropdown-item sort-option" data-sort="name">ðŸ”¤ Name (A-Z)</a></li>
        <li><a class="dropdown-item sort-option" data-sort="exp">ðŸ§  Experience</a></li>
      </ul>
    </div>
    <a href="/institution/addTutor"
    class="btn-orange-outline ms-auto">
   <i class="bi bi-person-plus-fill"></i>
   Add Tutor
 </a> 
  </div>
</div>
  </div>
</div>

<div class="container px-5 py-4">
  <div class="table-responsive">
    <table class="table align-middle border-0">
      <thead class="table-light">
        <tr>
          <th class="ps-4">Name</th>
        </tr>
      </thead>
      <tbody>
        <% user.forEach(user => { %>
          <tr class="border-bottom">
            <td class="ps-4 py-3">
              <div class="d-flex align-items-center gap-3">
                <div class="rounded-circle bg-secondary" style="width: 36px; height: 36px;"></div>
                <div>
                  <div class="fw-semibold"><%= user.name %></div>
                  <div class="text-muted small"><%= user.email %></div>
                </div>
              </div>
            </td>
            <td class="py-3">
              <% (user.field || []).forEach(field => { %>
                <span class="badge bg-danger-subtle text-danger-emphasis rounded-pill px-3 py-1 me-1">
                  <%= field %>
                </span>
              <% }) %>
            </td>
            <td class="py-3 text-end pe-4">
              <a href="/institution/tutorDetail/<%= user._id %>" class="text-primary">Details</a>
            </td>
          </tr>
        <% }) %>
      </tbody>
    </table>
  </div>
</div>
<style>
  .btn-orange-outline {
    border: 2px solid #e07b4f;
    background-color: white;
    color: #e07b4f;
    border-radius: 50px;
    padding: 8px 20px;
    font-weight: 600;
    display: inline-flex;
    align-items: center;
    gap: 6px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
    transition: all 0.2s ease;
    text-decoration: none;
  }

  .btn-orange-outline:hover {
    background-color: #e07b4f;
    color: white;
  }

  .btn-orange-outline i {
    font-size: 16px;
  }
</style>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const tutorTableBody = document.querySelector("table tbody");

    const getRowValue = (row, key) => {
  if (key === "title" || key === "name") {
    return row.querySelector(".fw-semibold")?.textContent.trim().toLowerCase();
  }
  if (key === "exp") {
    const expText = row.children[2]?.textContent || "";
    const match = expText.match(/\d+/);
    return match ? parseInt(match[0]) : 0;
  }
  return "";
};

    const sortRows = (key) => {
      const rows = Array.from(tutorTableBody.querySelectorAll("tr"));

      rows.sort((a, b) => {
        const valA = getRowValue(a, key);
        const valB = getRowValue(b, key);
        return typeof valA === "string" ? valA.localeCompare(valB) : valB - valA;
      });

      tutorTableBody.innerHTML = "";
      rows.forEach(row => tutorTableBody.appendChild(row));
    };

    document.querySelectorAll(".sort-option").forEach(option => {
      option.addEventListener("click", () => {
        const key = option.dataset.sort;
        if (["title", "name"].includes(key)) {
          sortRows("name");
        } else if (key === "students" || key === "rating" || key === "date") {
          alert("This sort option is only available on course pages.");
        } else if (key === "exp") {
          sortRows("exp");
        }
      });
    });
  });


</script>