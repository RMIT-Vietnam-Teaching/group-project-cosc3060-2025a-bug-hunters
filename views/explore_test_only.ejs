<!DOCTYPE html>
<html>
<head>
    <title>Explore Users</title>
    <link rel="stylesheet" href="https://cdn.simplecss.org/simple.min.css">
</head>
<body>
    <h2>Welcome, <%= currentUser.email %>!</h2>
    <h3>Explore Users</h3>
    <ul>
        <% userList.forEach(user => { %>
            <li>
                <%= user.email %> 
                <button 
                    class="follow-btn" 
                    data-user-id="<%= user._id %>" 
                    data-following="<%= user.isFollowing %>">
                    <%= user.isFollowing ? 'Unfollow' : 'Follow' %>
                </button>
            </li>
        <% }); %>
    </ul>

    <script>
        document.querySelectorAll('.follow-btn').forEach(button => {
    button.addEventListener('click', async () => {
        const userId = button.getAttribute('data-user-id');
        const isFollowing = button.getAttribute('data-following') === 'true';

        const endpoint = isFollowing ? '/user/unfollow/' : '/user/follow/';
        const res = await fetch(endpoint + userId, {
            method: 'POST'
        });

        if (res.ok) {
            button.textContent = isFollowing ? 'Follow' : 'Unfollow';
            button.setAttribute('data-following', (!isFollowing).toString());
        }
    });
});

    </script>
</body>
</html>
